<div th:fragment="list_product">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h3 class="fw-bold mb-0">Products</h3>
        <a th:href="@{/createProduct}" class="btn btn-primary shadow-sm">
            <i class="bi bi-plus-circle me-1"></i> Create Product
        </a>
    </div>

    <!-- Success Message -->
    <div th:if="${successMessage}" 
         class="alert alert-success alert-dismissible fade show" role="alert">
        <span th:text="${successMessage}"></span>
        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
    </div>

    <!-- No Products -->
    <div th:if="${products == null or #lists.isEmpty(products)}">
        <div class="alert alert-info text-center py-4 shadow-sm">
            <i class="bi bi-box-seam fs-3 d-block mb-2"></i>
            No products yet. Click "Create Product" to add some.
        </div>
    </div>

    <!-- Product Table -->
    <div class="table-responsive shadow-sm rounded">
        <table class="table table-striped table-hover align-middle mb-0">
            <thead class="table-dark">
                <tr>
                    <th>#</th>
                    <th>Image</th>
                    <th>Name</th>
                    <th>Description</th>
                    <th>Price ($)</th>
                    <th>Created At</th>
                    <th>Updated At</th>
                    <th class="text-center">Actions</th>
                </tr>
            </thead>

            <tbody>
                <tr th:each="prod, stat : ${products}">
                    <td th:text="${stat.count}"></td>

                    <!-- Image -->
                    <td>
                        <img th:if="${prod.imagePath}" th:src="${prod.imagePath}"
                             alt="Product Image"
                             class="img-thumbnail rounded"
                             style="width:70px; height:70px; object-fit:cover;">
                        <span th:if="${prod.imagePath == null}" class="text-muted">No Image</span>
                    </td>

                    <!-- Product Info -->
                    <td class="fw-semibold" th:text="${prod.name}"></td>
                    <td class="text-muted" th:text="${prod.description}"></td>

                    <!-- Price -->
                    <td>
                        <span class="badge bg-success px-3 py-2"
                              th:text="${prod.price}">0.00</span>
                    </td>

                    <td th:text="${prod.createdAtFormatted}"></td>
                    <td th:text="${prod.updatedAtFormatted}"></td>

                    <td class="text-center">
                        <a th:href="@{|/product/edit/${prod.id}|}" class="btn btn-sm btn-outline-secondary me-1">
                            <i class="bi bi-pencil-square"></i>
                        </a>

                        <form th:action="@{/delete-product}" method="post"
                              class="d-inline"
                              onsubmit="return confirm('Are you sure you want to delete this product?');">
                            <input type="hidden" name="id" th:value="${prod.id}">
                            <button type="submit" class="btn btn-sm btn-outline-danger">
                                <i class="bi bi-trash3"></i>
                            </button>
                        </form>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
</div>
